---
layout: translation
title: Pro Git 4.2 Git на сервере Установка Git на сервер
---
<h2 id='_git__'>Установка Git на сервер</h2>

<p>Для того чтобы приступить к установке любого сервера Git, вы должны экспортировать существующий репозиторий в новый &#8220;голый&#8221; репозиторий, т.е. репозиторий без рабочего каталога. Обычно это несложно сделать. Чтобы склонировать ваш репозиторий и создать новый &#8220;голый&#8221; репозиторий, выполните команду clone с параметром <code>--bare</code>. По существующему соглашению, каталоги с голыми репозиториями заканчиваются на <code>.git</code>, например:</p>

<pre><code>$ git clone --bare my_project my_project.git
Initialized empty Git repository in /opt/projects/my_project.git/</code></pre>

<p>Вывод этой команды слегка обескураживает. Поскольку <code>clone</code> по сути это <code>git init</code>, а затем <code>git fetch</code>, мы видим вывод от <code>git init</code>, который создает пустой каталог. Реальное перемещение объектов не имеет вывода, однако оно происходит. Теперь у вас должна быть копия данных из каталога Git в каталоге <code>my_project.git</code>.</p>

<p>Грубо говоря, это что-то наподобие этого:</p>

<pre><code>$ cp -Rf my_project/.git my_project.git</code></pre>

<p>Тут есть пара небольших различий в файле конфигурации, но в вашем случае эту разницу можно считать несущественной. Можно считать, что в этом случае берется собственно репозиторий Git без рабочего каталога, и создается каталог только для него.</p>

<h3 id='____'>Размещение &#8220;голого&#8221; репозитория на сервере</h3>

<p>Теперь, когда у вас есть голая копия вашего репозитория, все что вам нужно сделать это поместить ее на сервер и настроить протоколы. Условимся, что вы уже настроили сервер <code>git.example.com</code>, имеете к нему доступ по SSH и хотите размещать все ваши репозитории Git в каталоге <code>/opt/git</code>. Вы можете добавить ваш новый репозиторий копированием голого репозитория:</p>

<pre><code>$ scp -r my_project.git user@git.example.com:/opt/git</code></pre>

<p>Теперь другие пользователи, имеющие доступ к серверу по SSH и право на чтение к каталогу <code>/opt/git</code>, могут склонировать ваш репозиторий выполнив:</p>

<pre><code>$ git clone user@git.example.com:/opt/git/my_project.git</code></pre>

<p>Если у пользователя сервера есть право на запись в каталог <code>/opt/git/my_project.git</code>, он автоматически получает возможность отправки изменений в репозиторий. Git автоматически добавит право на запись в репозиторий для группы, если вы запустите команду <code>git init</code> с параметром <code>--shared</code>.</p>

<pre><code>$ ssh user@git.example.com
$ cd /opt/git/my_project.git
$ git init --bare --shared</code></pre>

<p>Видите, это просто взять репозиторий Git, создать &#8220;голую&#8221; версию и поместить ее на сервер, к которому вы и ваши коллеги имеете доступ по SSH. Теперь вы готовы работать вместе над одним проектом.</p>

<p>Важно отметить, что это практически всё, что вам нужно сделать чтобы получить рабочий Git-сервер, к которому несколько человек имеют доступ ― просто добавьте учетные записи SSH на сервер, и положите голый репозиторий в место, к которому эти пользователи имеют доступ на чтение и запись. И всё.</p>

<p>Из нескольких последующих разделов вы узнаете, как получить более сложные конфигурации. В том числе как не создавать учетные записи для каждого пользователя, как сделать публичный доступ на чтение репозитория, как установить веб-интерфейс, как использовать Gitosis, и др. Однако, помните, что для совместной работы пары человек на закрытом проекте, всё, что вам <em>нужно</em> ― это SSH-сервер и &#8220;голый&#8221; репозиторий.</p>

<h3 id='_'>Малые установки</h3>

<p>Если вы небольшая фирма, или вы только пробуете Git в вашей организации и у вас мало разработчиков, то все достаточно просто. Один из наиболее сложных аспектов настройки сервера Git ― управление пользователями. Если вы хотите чтобы некоторые репозитории были доступны некоторым пользователям только на чтение, а другие и на чтение и на запись, вам может быть не очень просто привести права доступа в порядок.</p>

<h4 id='ssh_'>SSH доступ</h4>

<p>Если у вас уже есть сервер, к которому все ваши разработчики имеют доступ по SSH, проще всего разместить ваш первый репозиторий там, поскольку вам не нужно практически ничего делать (как мы уже обсудили в предыдущем разделе). Если вы хотите более сложного управления правами доступа к вашим репозиториям, вы можете сделать это обычными правами файловой системы, предоставляемыми операционной системой вашего сервера.</p>

<p>Если вы хотите разместить ваши репозитории на сервер, на котором нет учетных записей для каждого в вашей команде, кому нужен доступ на запись, вы должны настроить доступ по SSH для них. Будем считать, что если у вас есть сервер, на котором вы хотите это сделать, то SSH-сервер на нем уже установлен, и через него вы имеете доступ к серверу.</p>

<p>Есть несколько способов дать доступ каждому в вашей команде. Первый — настроить учетные записи для каждого. Это просто, но может быть весьма обременительно. Вероятно, вы не захотите для каждого пользователя выполнять <code>adduser</code> и задавать временные пароли.</p>

<p>Второй способ ― создать на машине одного пользователя &#8216;git&#8217;, попросить каждого пользователя, кому нужен доступ на запись, прислать вам публичный ключ SSH, и добавить эти ключи в файл <code>~/.ssh/authorized_keys</code> вашего нового пользователя &#8216;git&#8217;. Теперь все будут иметь доступ к этой машине через пользователя &#8216;git&#8217;. Это никак не повлияет на данные коммита ― пользователь, под которым вы соединяетесь с сервером по SSH, не затрагивает сделанные вами коммиты.</p>

<p>Другой способ сделать это ― использовать SSH-сервер, аутентифицирующий по LDAP-серверу или любому другому централизованному источнику, который у вас может быть уже настроен. Любой способ аутентификации по SSH, какой вы только сможете придумать, должен работать, если пользователь может получить доступ к консоли.</p>

<div id='nav'>
<a href='ch4-1.html'>prev</a> | <a href='ch4-3.html'>next</a>
</div>